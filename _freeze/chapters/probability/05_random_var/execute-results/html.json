{
  "hash": "27ec762ef5192b5d931173a94d12ab15",
  "result": {
    "engine": "knitr",
    "markdown": "# Variabili casuali {#sec-probability-random-var}\n\n::: callout-important\n## In questo capitolo imparerai a:\n\n- comprendere le definizioni e le caratteristiche delle variabili casuali discrete e continue, nonché le loro distribuzioni di probabilità;\n- calcolare e interpretare il valore atteso di variabili casuali, sia discrete che continue;\n- determinare e comprendere la varianza e la deviazione standard di variabili casuali discrete e continue, esplorando come queste misure di dispersione descrivano la variabilità dei dati.\n:::\n\n::: callout-tip\n## Prerequisiti\n\n- Leggere l'appendice @sec-apx-calculus.\n:::\n\n::: callout-caution\n## Preparazione del Notebook\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> \n  source()\n```\n:::\n\n\n\n:::\n\n\n## Introduzione\n\nFinora, ci siamo concentrati sulle probabilità degli eventi. Ad esempio, abbiamo calcolato la probabilità di vincere il gioco di Monty Hall o di avere una rara condizione medica dato che il test è risultato positivo. Ma, in molti casi, vorremmo sapere di più. Ad esempio, quanti concorrenti devono giocare al gioco di Monty Hall fino a quando uno di loro finalmente vince? Quanto durerà questa condizione? Quanto perderò giocando d'azzardo con un dado sbilanciato tutta la notte? Per rispondere a queste domande, dobbiamo lavorare con le variabili casuali. In questo capitolo, introduciamo le variabili casuali e le loro proprietà.\n\n## Definizione\n\nLe variabili casuali sono risultati numerici derivanti da processi aleatori. Esse ci consentono di trasformare risultati qualitativi (ad esempio $X = \\{\\Box, \\clubsuit, \\diamondsuit, \\heartsuit, \\spadesuit\\}$) in valori numerici, semplificando così l'analisi matematica.\n\nFormalmente, una variabile casuale è definita come una funzione che associa ogni elemento di uno spazio campionario $S$ a un valore in un sottoinsieme dei numeri reali $\\mathbb{R}$. Questa definizione consente di esprimere numericamente gli esiti di un fenomeno aleatorio, associando un valore specifico a ciascun possibile risultato dell'esperimento.\n\n::: {#exm-}\nUn esempio è la variabile casuale $X$, che rappresenta il risultato del lancio di un dado. Se definiamo $X = 1$ per indicare che il risultato del lancio è un numero dispari (1, 3 o 5) e $X = 0$ per indicare che il risultato è un numero pari (2, 4 o 6), abbiamo trasformato un'osservazione fisica (il lancio del dado) in un valore numerico che rappresenta una determinata categoria di eventi.\n:::\n\n## Tipologie di Variabili Casuali\n\nLe variabili casuali possono essere suddivise in due categorie principali: discrete e continue. Una variabile casuale discreta assume valori all'interno di un insieme finito o al massimo numerabile, il che significa che i suoi possibili esiti possono essere contati, anche se l'insieme è infinito. Al contrario, una variabile casuale continua può assumere un'infinità di valori all'interno di un intervallo, essendo in grado di coprire ogni punto di quell'intervallo senza interruzioni.\n\n## Convenzioni Notazionali\n\nNella teoria della probabilità, è usuale adottare una specifica convenzione di notazione per le variabili casuali e i loro esiti. Comunemente, si utilizzano le lettere maiuscole, come $X$, per indicare una variabile casuale, ovvero un concetto che rappresenta una serie di possibili esiti di un fenomeno aleatorio. D'altro canto, la corrispondente lettera minuscola, $x$ nel nostro esempio, è impiegata per denotare una specifica realizzazione o un esito particolare che la variabile casuale può assumere. Questa distinzione aiuta a chiarire se si sta parlando della variabile casuale nel suo insieme ($X$) o di un suo specifico valore ($x$).\n\n## Variabili casuali multiple\n\nNella teoria della probabilità, le variabili casuali spesso interagiscono o si combinano tra loro. Consideriamo l'esempio di tre lanci di una moneta bilanciata, rappresentati da variabili casuali indipendenti $X_1$, $X_2$, e $X_3$. Per ogni lancio:\n\n- $P(X_n = 1)$ (testa) = 0.5,\n- $P(X_n = 0)$ (croce) = 0.5,\n\ndove $n = 1, 2, 3$.\n\nCombinando queste variabili, possiamo creare nuove variabili casuali. Ad esempio, definiamo $Z$ come la somma dei risultati:\n\n$$\nZ = X_1 + X_2 + X_3.\n$$\n\n$Z$ è una variabile casuale discreta che rappresenta il numero totale di teste ottenute nei tre lanci. I suoi possibili valori sono 0, 1, 2, e 3.\n\nQuesto esempio illustra come variabili casuali indipendenti possano essere combinate per creare nuove variabili casuali.\n\n## Distribuzione di Probabilità {#sec-fun-mass-prob}\n\nLa distribuzione di probabilità è un concetto fondamentale nella teoria della probabilità, che descrive come le probabilità si distribuiscono tra i possibili esiti di una variabile casuale. La sua rappresentazione varia a seconda che si tratti di variabili casuali discrete o continue.\n\n### Variabili Casuali Discrete\n\nPer le variabili casuali discrete, che assumono valori specifici e contabili, la distribuzione di probabilità è rappresentata dalla *funzione di massa di probabilità*, indicata come $P(\\cdot)$.\n\n#### Funzione di Massa di Probabilità\n\nLa funzione di massa di probabilità assegna una probabilità precisa a ciascun possibile esito della variabile casuale discreta. Ad esempio, per il lancio di un dado equilibrato:\n\n$P(Y = 1) = \\frac{1}{6}$.\n\nQuesto significa che la probabilità di ottenere \"1\" in un singolo lancio è 1/6.\n\n#### Istogrammi per Variabili Discrete\n\nGli istogrammi sono strumenti visivi efficaci per rappresentare la distribuzione di probabilità delle variabili casuali discrete. Per queste variabili, possiamo impostare ciascun bin dell'istogramma in modo che copra un singolo valore della variabile casuale. L'altezza di ogni bin corrisponde alla probabilità di quel valore specifico.\n\nGli istogrammi ci permettono di identificare rapidamente caratteristiche importanti della distribuzione, come:\n\n1. unimodalità: concentrazione attorno a un singolo punto;\n2. multimodalità: concentrazione attorno a più punti;\n3. simmetria o asimmetria della distribuzione;\n4. dispersione dei valori.\n\n### Variabili Casuali Continue\n\nPer le variabili casuali continue, che possono assumere un'infinità di valori in un intervallo, si utilizza la *funzione di densità di probabilità*, indicata come $p(\\cdot)$.\n\n#### Funzione di Densità di Probabilità\n\nLa funzione di densità di probabilità non assegna probabilità a singoli valori (che sarebbe zero per una variabile continua), ma determina la probabilità che la variabile si trovi all'interno di un intervallo specifico.\n\n#### Istogrammi per Variabili Continue\n\nAnche per le variabili continue possiamo usare istogrammi, ma in questo caso i bin devono sempre coprire intervalli di valori. Riducendo progressivamente la larghezza dei bin, il profilo dell'istogramma tende a coincidere con la funzione di densità di probabilità della variabile casuale.\n\n### Supporto della Variabile Casuale\n\nIl supporto di una variabile casuale è l'insieme di tutti i valori che la variabile può effettivamente assumere. Ad esempio:\n\n- per un dado a sei facce: {1, 2, 3, 4, 5, 6};\n- per una distribuzione gaussiana: l'intero insieme dei numeri reali.\n\n### Assegnazione di Probabilità\n\n- Per variabili discrete: si specifica la probabilità di ogni possibile valore.\n- Per variabili continue: si utilizza la densità di probabilità per calcolare la probabilità di intervalli di valori.\n\nLa distribuzione di probabilità, sia per variabili discrete che continue, fornisce una descrizione completa del comportamento probabilistico della variabile casuale, permettendo analisi e previsioni accurate in vari campi di applicazione.\n\n::: {#exm-}\n\nConsideriamo l'esperimento casuale costituito dal lancio di due dadi equilibrati. Definiamo la variabile casuale $X$ come la somma dei punti ottenuti dai due dadi.\n\nLo spazio campionario $S$ è l'insieme di tutte le possibili coppie ordinate $(a,b)$, dove $a$ e $b$ rappresentano i risultati del primo e del secondo dado rispettivamente:\n\n$$\nS = {(1,1), (1,2), ..., (1,6), (2,1), (2,2), ..., (2,6), ..., (6,1), (6,2), ..., (6,6)}.\n$$\n\nIn totale, ci sono 6 × 6 = 36 possibili esiti.\n\nLa variabile casuale $X$ è definita come la somma dei punti dei due dadi. Quindi:\n\n$$\nX = a + b, \\quad \\text{dove } (a,b) \\in S.\n$$\n\n$X$ può assumere valori interi da 2 (1+1) a 12 (6+6).\n\nLa distribuzione della variabile casuale $X$ è una funzione che associa a ogni possibile valore di $X$ la sua probabilità. In questo caso, poiché $X$ è discreta, usiamo una funzione di massa di probabilità.\n\nPer calcolare la probabilità di ogni valore di $X$, contiamo il numero di casi favorevoli e lo dividiamo per il numero totale di casi possibili (36).\n\n| X  | Casi favorevoli                  | Numero di casi | Probabilità P(X = x) |\n|----|----------------------------------|----------------|----------------------|\n| 2  | (1,1)                            | 1              | 1/36                 |\n| 3  | (1,2), (2,1)                     | 2              | 2/36 = 1/18          |\n| 4  | (1,3), (2,2), (3,1)              | 3              | 3/36 = 1/12          |\n| 5  | (1,4), (2,3), (3,2), (4,1)       | 4              | 4/36 = 1/9           |\n| 6  | (1,5), (2,4), (3,3), (4,2), (5,1)| 5              | 5/36                 |\n| 7  | (1,6), (2,5), (3,4), (4,3), (5,2), (6,1) | 6      | 6/36 = 1/6           |\n| 8  | (2,6), (3,5), (4,4), (5,3), (6,2)| 5              | 5/36                 |\n| 9  | (3,6), (4,5), (5,4), (6,3)       | 4              | 4/36 = 1/9           |\n| 10 | (4,6), (5,5), (6,4)              | 3              | 3/36 = 1/12          |\n| 11 | (5,6), (6,5)                     | 2              | 2/36 = 1/18          |\n| 12 | (6,6)                            | 1              | 1/36                 |\n\nQuesta tabella rappresenta la distribuzione completa della variabile casuale $X$.\n\nIn conclusione, la distribuzione di una variabile casuale discreta, come nell'esempio della somma dei punti di due dadi, fornisce una descrizione completa delle proprietà probabilistiche della variabile. Essa associa a ogni possibile valore della variabile la sua probabilità di verificarsi.\n\nIn questo caso, la distribuzione ci dice, per esempio, che la probabilità di ottenere una somma di 7 è 1/6, la più alta tra tutti i possibili risultati. Questo è dovuto al fatto che ci sono più combinazioni che producono una somma di 7 rispetto a qualsiasi altro risultato.\n\nLa distribuzione ci permette di rispondere a domande come:\n\n- Qual è la probabilità di ottenere una somma pari? (Sommando le probabilità di 2, 4, 6, 8, 10, 12).\n- Qual è la probabilità di ottenere una somma maggiore o uguale a 10? (Sommando le probabilità di 10, 11, 12).\n\nLa distribuzione di massa di probabilità della variabile casuale $X$ può essere rappresentata visivamente utilizzando un istogramma. Un istogramma permette di vedere immediatamente la probabilità associata a ciascun valore di $X$, rendendo chiaro quali risultati sono più probabili e quali lo sono meno.\n\nLe istruzioni Python necessarie per generare questo istogramma sono fornite di seguito.\n\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Valori possibili della variabile casuale X\nvalori_X <- c(2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)\n\n# Probabilità associate a ciascun valore di X\nprobabilita_X <- c(\n  1 / 36,\n  2 / 36,\n  3 / 36,\n  4 / 36,\n  5 / 36,\n  6 / 36,\n  5 / 36,\n  4 / 36,\n  3 / 36,\n  2 / 36,\n  1 / 36\n)\n\n# Creazione dell'istogramma\nbarplot(\n  probabilita_X,\n  names.arg = valori_X,\n  col = rgb(0, 0, 1, alpha = 0.5),\n  border = \"black\",\n  xlab = \"Valore della variabile casuale X\",\n  ylab = \"Probabilità P(X = x)\",\n  main = \"Distribuzione di Massa di Probabilità della Variabile Casuale X\"\n)\n```\n\n::: {.cell-output-display}\n![](05_random_var_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n\n\n## Funzione di Distribuzione Cumulativa (CDF)\n\nLa Funzione di Distribuzione Cumulativa (CDF) è uno strumento fondamentale nella teoria della probabilità per descrivere la distribuzione di una variabile casuale.\n\n### Definizione\n\nPer una variabile casuale $X$, la funzione di distribuzione cumulativa $F(x)$ è definita come:\n\n$$\nF(x) = P(X \\leq x),\n$$\n\ndove:\n\n- $X$ è la variabile casuale.\n- $P(X \\leq x)$ rappresenta la probabilità che $X$ assuma un valore minore o uguale a $x$.\n\nIn altre parole, $F(x)$ quantifica la probabilità cumulativa dall'estremo inferiore dello spazio di probabilità fino al punto $x$.\n\n### Proprietà della CDF\n\n1. **Monotonia non decrescente**:\n   \n   - Per $x_1 < x_2$, $F(x_1) \\leq F(x_2)$.\n   - La CDF non diminuisce mai quando ci si sposta da sinistra a destra lungo l'asse $x$.\n\n2. **Normalizzazione**:\n   \n   - $\\lim_{{x \\to -\\infty}} F(x) = 0 \\quad \\text{e} \\quad \\lim_{{x \\to +\\infty}} F(x) = 1$.\n   - La CDF parte da 0 quando $x$ tende a $-\\infty$ e raggiunge 1 quando $x$ tende a $+\\infty$.\n\n3. **Continuità a destra**:\n   \n   - $F(x) = \\lim_{{y \\to x^+}} F(y)$.\n   - La CDF è continua da destra, il che significa che non presenta salti improvvisi quando ci si avvicina a un punto da destra.\n\n### CDF per Variabili Casuali Discrete\n\nPer una variabile casuale discreta $X$, la CDF (anche chiamata *funzione di ripartizione cumulativa*) è definita come:\n\n$$\nF(x) = P(X \\leq x) = \\sum_{x_i \\leq x} P(X = x_i),\n$$\n\ndove la somma è calcolata su tutti i valori $x_i$ minori o uguali a $x$.\n\n### Importanza e Applicazioni\n\n1. La CDF offre una rappresentazione visiva di come le probabilità si accumulano lungo l'intero intervallo dei possibili valori della variabile casuale.\n\n2. La CDF permette di calcolare facilmente la probabilità che $X$ cada in un intervallo specifico:\n\n$$\nP(a < X \\leq b) = F(b) - F(a).\n$$\n\n3. La CDF è utilizzata in vari metodi di generazione di variabili casuali, come il metodo della trasformazione inversa.\n\n4. Le CDF facilitano il confronto tra diverse distribuzioni di probabilità, consentendo di valutare differenze nelle loro caratteristiche cumulative.\n\nIn conclusione, la CDF è uno strumento versatile e potente che fornisce una descrizione completa della distribuzione di probabilità di una variabile casuale, sia essa discreta o continua.\n\n::: {#exm-4}\n\nNel caso del lancio di due dadi, con la variabile casuale $Z$ definita come la somma dei loro valori, la funzione di distribuzione cumulativa $F(z)$ può essere illustrata come segue:\n\n| $z$ | $P(Z = z)$ | $F(z)$  |\n|:-------:|:--------------:|:-----------:|\n| 2       | $\\frac{1}{36}$ | $\\frac{1}{36}$  |\n| 3       | $\\frac{2}{36}$ | $\\frac{3}{36}$  |\n| 4       | $\\frac{3}{36}$ | $\\frac{6}{36}$  |\n| 5       | $\\frac{4}{36}$ | $\\frac{10}{36}$ |\n| 6       | $\\frac{5}{36}$ | $\\frac{15}{36}$ |\n| 7       | $\\frac{6}{36}$ | $\\frac{21}{36}$ |\n| 8       | $\\frac{5}{36}$ | $\\frac{26}{36}$ |\n| 9       | $\\frac{4}{36}$ | $\\frac{30}{36}$ |\n| 10      | $\\frac{3}{36}$ | $\\frac{33}{36}$ |\n| 11      | $\\frac{2}{36}$ | $\\frac{35}{36}$ |\n| 12      | $\\frac{1}{36}$ | $\\frac{36}{36}$ |\n\nIn questa tabella:\n\n- $P(Z = z)$ rappresenta la probabilità che la somma dei due dadi sia esattamente $z$.\n- $F(z)$ è la funzione di distribuzione cumulativa, che fornisce la probabilità che la somma $Z$ sia minore o uguale a $z$.\n\nQuesta tabella mostra come le probabilità cumulative si accumulano per la variabile casuale $Z$, evidenziando la distribuzione delle somme possibili quando si lanciano due dadi. Ad esempio, $F(7) = \\frac{21}{36}$ indica che la probabilità che la somma sia 7 o inferiore è $\\frac{21}{36}$.\n\n:::\n\n## Trovare la Distribuzione di Probabilità attraverso una Simulazione\n\nLa distribuzione di probabilità teorica per il lancio di due dadi può essere calcolata analiticamente, ma un'alternativa altrettanto valida è ottenere una stima empirica tramite simulazione. Questo approccio consiste nel ripetere l'esperimento casuale un numero elevato di volte e analizzare le frequenze relative dei risultati ottenuti. Aumentando il numero di simulazioni, la distribuzione empirica tende a convergere verso quella teorica.\n\nDi seguito vedremo come implementare una simulazione in R per calcolare la distribuzione empirica di probabilità dei risultati ottenuti sommando i punteggi di due dadi.\n\n::: {#exm-5}\n\nIniziamo definendo una funzione che simula il lancio di un dado a sei facce, restituendo un valore casuale tra 1 e 6.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Funzione per simulare il lancio di un dado\nroll_die <- function() {\n  sample(1:6, size = 1)\n}\n```\n:::\n\n\n\n\nPossiamo ora definire una funzione che calcola la somma dei valori di due dadi lanciati simultaneamente. La funzione accetta come argomento il numero di ripetizioni da effettuare e restituisce un vettore contenente i risultati.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Funzione per simulare il lancio di due dadi per n volte\nroll_two_dice <- function(n) {\n  map_dbl(1:n, ~ roll_die() + roll_die())\n}\n```\n:::\n\n\n\n\nUtilizziamo la funzione appena definita per simulare 100.000 lanci di due dadi. Memorizziamo i risultati in un oggetto `res` e visualizziamo i primi 20 valori.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Numero di simulazioni\nnrolls <- 100000\n\n# Simula i risultati del lancio di due dadi\nres <- roll_two_dice(nrolls)\n\n# Visualizza i primi 20 risultati\ncat(res[1:20], \"\\n\")\n#> 6 2 6 4 5 6 10 4 4 4 9 10 6 7 3 8 9 6 10 7\n```\n:::\n\n\n\n\nUtilizzando il `tidyverse`, possiamo creare un DataFrame contenente i risultati della simulazione e calcolare la distribuzione empirica delle probabilità. Per fare ciò, calcoliamo le frequenze assolute dei risultati, le normalizziamo dividendo per il numero totale di simulazioni e assicuriamo che siano rappresentati tutti i possibili valori (da 2 a 12).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Converti i risultati in un DataFrame (tibble)\ndf <- tibble(y = res)\n\n# Calcola la distribuzione empirica delle probabilità\nempirical_probs <- df %>%\n  count(y) %>%                             # Calcola le frequenze assolute\n  complete(y = 2:12, fill = list(n = 0)) %>% # Assicura che tutti i valori siano inclusi\n  mutate(prob = n / nrolls)                # Calcola le probabilità relative\n\n# Visualizza la distribuzione empirica\nempirical_probs %>%\n  dplyr::select(y, prob)\n#> # A tibble: 11 × 2\n#>       y   prob\n#>   <dbl>  <dbl>\n#> 1     2 0.0282\n#> 2     3 0.0566\n#> 3     4 0.0849\n#> 4     5 0.111 \n#> 5     6 0.139 \n#> 6     7 0.165 \n#> # ℹ 5 more rows\n```\n:::\n\n\n\n\nIl risultato finale è una tabella che mostra i valori possibili (da 2 a 12) e la loro probabilità empirica stimata. Questa distribuzione empirica dovrebbe essere molto simile alla distribuzione teorica, specialmente considerando un numero elevato di simulazioni.\n\nQuesto approccio dimostra come sia possibile utilizzare la simulazione per approssimare distribuzioni di probabilità, una tecnica particolarmente utile quando la soluzione analitica non è immediatamente disponibile.\n:::\n\n## Informazioni sull'Ambiente di Sviluppo\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.4.2 (2024-10-31)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.2\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] viridis_0.6.5     viridisLite_0.4.2 gridExtra_2.3     patchwork_1.3.0  \n#>  [5] bayesplot_1.11.1  psych_2.4.6.26    scales_1.3.0      markdown_1.13    \n#>  [9] knitr_1.49        lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    \n#> [13] dplyr_1.1.4       purrr_1.0.2       readr_2.1.5       tidyr_1.3.1      \n#> [17] tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0   rio_1.2.3        \n#> [21] here_1.0.1       \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] utf8_1.2.4        generics_0.1.3    stringi_1.8.4     lattice_0.22-6   \n#>  [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.1   \n#>  [9] grid_4.4.2        timechange_0.3.0  fastmap_1.2.0     rprojroot_2.0.4  \n#> [13] jsonlite_1.8.9    fansi_1.0.6       mnormt_2.1.1      cli_3.6.3        \n#> [17] rlang_1.1.4       munsell_0.5.1     withr_3.0.2       tools_4.4.2      \n#> [21] parallel_4.4.2    tzdb_0.4.0        colorspace_2.1-1  pacman_0.5.1     \n#> [25] vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4   htmlwidgets_1.6.4\n#> [29] pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.6      glue_1.8.0       \n#> [33] xfun_0.49         tidyselect_1.2.1  farver_2.1.2      htmltools_0.5.8.1\n#> [37] nlme_3.1-166      rmarkdown_2.29    compiler_4.4.2\n```\n:::\n",
    "supporting": [
      "05_random_var_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}