{
  "hash": "0e389ba49faa2b71564458d5640cf684",
  "result": {
    "engine": "knitr",
    "markdown": "# Indicatori di tendenza centrale e variabilità {#sec-central-tendency-variability}\n\n::: callout-note\n## In questo capitolo imparerai a\n\n- Calcolare e interpretare i principali indici di tendenza centrale e di variabilità.\n:::\n\n::: callout-tip\n## Prerequisiti\n\n- Leggere \"Most Psychological Researchers Assume Their Samples Are Ergodic: Evidence From a Year of Articles in Three Major Journals\" [@speelman2024most].\n:::\n\n::: callout-important\n## Preparazione del Notebook\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> \n  source()\n\n# Load packages\nif (!requireNamespace(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(tidyr, viridis, vcd)\n```\n:::\n\n\n\n:::\n\n## Introduzione\n\nLa visualizzazione grafica dei dati rappresenta il pilastro fondamentale di ogni analisi quantitativa. Grazie alle rappresentazioni grafiche adeguate, è possibile individuare importanti caratteristiche di una distribuzione, quali la simmetria o l'asimmetria, nonché la presenza di una o più mode. Successivamente, al fine di descrivere sinteticamente le principali caratteristiche dei dati, si rende necessario l'utilizzo di specifici indici numerici. In questo capitolo, verranno presentati i principali indicatori della statistica descrittiva.\n\n## Indici di Tendenza Centrale\n\nGli indici di tendenza centrale sono misure statistiche che cercano di rappresentare un valore tipico o centrale all'interno di un insieme di dati. Sono utilizzati per ottenere una comprensione immediata della distribuzione dei dati senza dover analizzare l'intero insieme. Gli indici di tendenza centrale sono fondamentali nell'analisi statistica, in quanto forniscono una sintesi semplice e comprensibile delle caratteristiche principali di un insieme di dati. I principali indici di tendenza centrale sono:\n\n1. **Media**: La media è la somma di tutti i valori divisa per il numero totale di valori. È spesso utilizzata come misura generale di tendenza centrale, ma è sensibile agli estremi (valori molto alti o molto bassi).\n2. **Mediana**: La mediana è il valore che divide l'insieme di dati in due parti uguali. A differenza della media, non è influenzata da valori estremi ed è quindi più robusta in presenza di outlier.\n3. **Moda**: La moda è il valore che appare più frequentemente in un insieme di dati. In alcuni casi, può non essere presente o esserci più di una moda.\n\nLa scelta dell'indice di tendenza centrale appropriato dipende dalla natura dei dati e dall'obiettivo dell'analisi. Ad esempio, la mediana potrebbe essere preferita alla media se l'insieme di dati contiene valori anomali che potrebbero distorcere la rappresentazione centrale. La conoscenza e l'applicazione corretta di questi indici possono fornire una preziosa intuizione sulle caratteristiche centrali di una distribuzione di dati.\n\n### Media\n\nLa media aritmetica di un insieme di valori rappresenta il punto centrale o il baricentro della distribuzione dei dati. È calcolata come la somma di tutti i valori divisa per il numero totale di valori, ed è espressa dalla formula:\n\n$$\n\\bar{x}=\\frac{1}{n}\\sum_{i=1}^n x_i,\n$$ {#eq-mean}\n\ndove $x_i$ rappresenta i valori nell'insieme, $n$ è il numero totale di valori, e $\\sum$ indica la sommatoria.\n\n#### Proprietà della Media\n\nUna proprietà fondamentale della media è che la somma degli scarti di ciascun valore dalla media è zero:\n\n$$\n\\sum_{i=1}^n (x_i - \\bar{x}) = 0.\\notag\n$$ {#eq-diffmeansumzero}\n\nInfatti,\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^n (x_i - \\bar{x}) &= \\sum_i x_i - \\sum_i \\bar{x}\\notag\\\\\n&= \\sum_i x_i - n \\bar{x}\\notag\\\\\n&= \\sum_i x_i - \\sum_i x_i = 0.\\notag\n\\end{aligned}\n$$\n\nQuesta proprietà implica che i dati sono equamente distribuiti intorno alla media.\n\n#### La media come Centro di Gravità dell'Istogramma\n\nLa media aritmetica può essere interpretata come il centro di gravità o il punto di equilibrio della distribuzione dei dati. In termini fisici, il centro di gravità è il punto in cui la massa di un sistema è equilibrata o concentrata.\n\nIn termini statistici, possiamo considerare la media come il punto in cui la distribuzione dei dati è in equilibrio. Ogni valore dell'insieme di dati può essere visto come un punto materiale con una massa proporzionale al suo valore. Se immaginiamo questi punti disposti su una linea, con valori più grandi a destra e più piccoli a sinistra, la media corrisponderà esattamente al punto in cui la distribuzione sarebbe in equilibrio.\n\n#### Principio dei Minimi Quadrati\n\nLa posizione della media minimizza la somma delle distanze quadrate dai dati, un principio noto come \"metodo dei minimi quadrati\". Matematicamente, questo si traduce nel fatto che la somma dei quadrati degli scarti tra ciascun valore e la media è minima. Questo principio è alla base dell'analisi statistica dei modelli di regressione e conferma l'interpretazione della media come centro di gravità dell'istogramma.\n\n#### Calcolo della Media con `R`\n\nPer calcolare la media di un piccolo numero di valori in Python, possiamo utilizzare la somma di questi valori e dividerla per il numero totale di elementi. Consideriamo ad esempio i valori 12, 44, 21, 62, 24:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(12 + 44 + 21 + 62 + 24) / 5\n#> [1] 32.6\n```\n:::\n\n\n\n\novvero\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(12, 44, 21, 62, 24)\nmean(x)\n#> [1] 32.6\n```\n:::\n\n\n\n\n#### Le Proporzioni Sono Medie\n\nSe una collezione consiste solo di uni e zeri, allora la somma della collezione è il numero di uni in essa, e la media della collezione è la proporzione di uni.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzero_one <- c(1, 1, 1, 0)\nresult <- mean(zero_one)\nresult\n#> [1] 0.75\n```\n:::\n\n\n\n\nÈ possibile sostituire 1 con il valore booleano True e 0 con False:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(c(TRUE, TRUE, TRUE, FALSE))\n#> [1] 0.75\n```\n:::\n\n\n\n\n#### Limiti della Media Aritmetica\n\nLa media aritmetica, tuttavia, ha alcune limitazioni: non sempre è l'indice più adeguato per descrivere accuratamente la tendenza centrale della distribuzione, specialmente quando si verificano asimmetrie o valori anomali (outlier). In queste situazioni, è più indicato utilizzare la mediana o la media spuntata (come spiegheremo successivamente).\n\n#### Medie per Gruppi\n\nMolto spesso però i nostri dati sono contenuti in file e inserire i dati manualmente non è fattibile. Per fare un esempio, considereremo i dati del Progetto STAR, contenuti nel file `STAR.csv`, che rappresentano un'importante indagine sulle prestazioni degli studenti in relazione alla dimensione delle classi. Negli anni '80, i legislatori del Tennessee considerarono la possibilità di ridurre le dimensioni delle classi per migliorare il rendimento degli studenti. Al fine di prendere decisioni informate, commissionarono lo studio multimilionario \"Progetto Student-Teacher Achievement Ratio\" (Project STAR). Lo studio coinvolgeva bambini della scuola materna assegnati casualmente a classi piccole, con 13-17 studenti, o classi di dimensioni regolari, con 22-25 studenti, fino alla fine della terza elementare. I ricercatori hanno seguito il progresso degli studenti nel tempo, concentrandosi su variabili di risultato, come i punteggi dei test standardizzati di lettura (reading) e matematica (math) alla terza elementare, oltre ai tassi di diploma di scuola superiore (graduated, con valore 1 per sì e 0 per no).\n\nPoniamoci il problema di calcolare la media dei punteggi `math` calcolata separatamente per i due gruppi di studenti: coloro che hanno completato la scuola superiore e coloro che non l'hanno completata.\n\nProcediamo all'importazione dei dati per iniziare l'analisi.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- rio::import(here::here(\"data\", \"STAR.csv\"))\ndf |> \n  head()\n#>   classtype reading math graduated\n#> 1     small     578  610         1\n#> 2   regular     612  612         1\n#> 3   regular     583  606         1\n#> 4     small     661  648         1\n#> 5     small     614  636         1\n#> 6   regular     610  603         0\n```\n:::\n\n\n\n\nEsaminiamo la numerosità di ciascun gruppo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  group_by(graduated) |> \n  summarize(count = n())\n#> # A tibble: 2 × 2\n#>   graduated count\n#>       <int> <int>\n#> 1         0   166\n#> 2         1  1108\n```\n:::\n\n\n\n\nOra procediamo al calcolo delle medie dei punteggi `math` all'interno dei due gruppi. Per rendere la risposta più concisa, useremo la funzione `round()` per stampare solo 2 valori decimali.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  group_by(graduated) |> \n  summarise(\n    mean_math = round(mean(math, na.rm = TRUE), 2)\n  )\n#> # A tibble: 2 × 2\n#>   graduated mean_math\n#>       <int>     <dbl>\n#> 1         0      607.\n#> 2         1      635.\n```\n:::\n\n\n\n\n### Media Spuntata\n\nLa *media spuntata*, indicata come $\\bar{x}_t$ o *trimmed mean*, è un metodo di calcolo della media che prevede l'eliminazione di una determinata percentuale di dati estremi prima di effettuare la media aritmetica. Solitamente, viene eliminato il 10% dei dati, ovvero il 5% all'inizio e alla fine della distribuzione. Per ottenere la media spuntata, i dati vengono ordinati in modo crescente, $x_1 \\leq x_2 \\leq x_3 \\leq \\dots \\leq x_n$, e quindi viene eliminato il primo 5% e l'ultimo 5% dei dati nella sequenza ordinata. Infine, la media spuntata è calcolata come la media aritmetica dei dati rimanenti. Questo approccio è utile quando ci sono valori anomali o quando la distribuzione è asimmetrica e la media aritmetica non rappresenta adeguatamente la tendenza centrale dei dati.\n\nA titolo di esempio, procediamo al calcolo della media spuntata dei valori `math` per i due gruppi definiti dalla variabile `graduated`, escludendo il 10% dei valori più estremi.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n#> Rows: 1,274\n#> Columns: 4\n#> $ classtype <chr> \"small\", \"regular\", \"regular\", \"small\", \"small\", \"regular…\n#> $ reading   <int> 578, 612, 583, 661, 614, 610, 595, 665, 616, 624, 593, 59…\n#> $ math      <int> 610, 612, 606, 648, 636, 603, 610, 631, 636, 626, 601, 56…\n#> $ graduated <int> 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, …\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnot_graduated <- df[df$graduated == 0, \"math\"]\nmean(not_graduated, trim = 0.10, na.rm = TRUE)\n#> [1] 606\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnot_graduated <- df[df$graduated == 1, \"math\"]\nmean(not_graduated, trim = 0.10, na.rm = TRUE)\n#> [1] 634\n```\n:::\n\n\n\n\n### Quantili\n\nIl quantile non interpolato di ordine $p$ $(0 < p < 1)$ rappresenta il valore che divide la distribuzione dei dati in modo tale che una frazione $p$ dei dati si trovi al di sotto di esso.\n\nLa formula per calcolare il quantile non interpolato è la seguente:\n\n$$\n    q_p = x_{(k)},\n$$\n\ndove $x_{(k)}$ è l'elemento $k$-esimo nell'insieme di dati ordinato in modo crescente, e $k$ è calcolato come:\n\n$$\nk = \\lceil p \\cdot n \\rceil,\n$$\n\ndove $n$ è il numero totale di dati nel campione, e $\\lceil \\cdot \\rceil$ rappresenta la funzione di arrotondamento all'intero successivo. In questa definizione, il quantile non interpolato corrisponde al valore effettivo nell'insieme di dati, senza effettuare alcuna interpolazione tra i valori circostanti.\n\nAd esempio, consideriamo il seguente insieme di dati: $\\{ 15, 20, 23, 25, 28, 30, 35, 40, 45, 50 \\}$. Supponiamo di voler calcolare il quantile non interpolato di ordine $p = 0.3$ (cioè il 30° percentile).\n\nOrdiniamo i dati in modo crescente: $\\{ 15, 20, 23, 25, 28, 30, 35, 40, 45, 50 \\}.$\nCalcoliamo $k$ utilizzando la formula $k = \\lceil p \\cdot n \\rceil$, dove $n$ è il numero totale di dati nel campione. Nel nostro caso, $n = 10$ e $p = 0.3$:\n\n$$\n k = \\lceil 0.3 \\cdot 10 \\rceil = \\lceil 3 \\rceil = 3. \n$$\n\nIl quantile non interpolato corrisponde al valore $x_{(k)}$, ovvero l'elemento $k$-esimo nell'insieme ordinato: $q_{0.3} = x_{(3)} = 23.$\n\nOltre al quantile non interpolato, esiste anche il concetto di quantile interpolato. A differenza del quantile non interpolato, il quantile interpolato può essere calcolato anche per percentili che non corrispondono esattamente a valori presenti nell'insieme di dati. Per ottenere il valore del quantile interpolato, viene utilizzato un procedimento di interpolazione lineare tra i valori adiacenti. In genere, il calcolo del quantile interpolato viene eseguito mediante l'uso di software dedicati.\n\nOra, procediamo al calcolo dei *quantili* di ordine 0.10 e 0.90 per i valori `math` all'interno dei due gruppi. I quantili sono dei valori che dividono la distribuzione dei dati in parti specifiche. Ad esempio, il quantile di ordine 0.10 corrisponde al valore al di sotto del quale si trova il 10% dei dati, mentre il quantile di ordine 0.90 rappresenta il valore al di sotto del quale si trova il 90% dei dati. \n\nCalcoliamo i quantili di ordine 0.1 e 0.9 della distribuzione dei punteggi `math` nei due gruppi definiti dalla variabile `graduated`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quantili di ordine 0.1 e 0.9 per il gruppo di studenti che hanno completato \n# la scuola superiore\nquantile(df[df$graduated == 1, \"math\"], probs = c(0.1, 0.9))\n#> 10% 90% \n#> 588 684\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quantili di ordine 0.1 e 0.9 per il gruppo di studenti che non hanno \n# completato la scuola superiore\nquantile(df[df$graduated == 0, \"math\"], probs = c(0.1, 0.9))\n#> 10% 90% \n#> 564 651\n```\n:::\n\n\n\n\n### Moda e Mediana\n\nIn precedenza abbiamo già incontrato altri due popolari indici di tendenza centrale: la *moda* (*Mo*), che rappresenta il valore centrale della classe con la frequenza massima (in alcune distribuzioni può esserci più di una moda, rendendola *multimodale* e facendo perdere a questo indice il suo significato di indicatore di tendenza centrale); e la *mediana* ($\\tilde{x}$), che rappresenta il valore corrispondente al quantile di ordine 0.5 della distribuzione.\n\n### Quando Usare Media, Moda, Mediana\n\nLa moda può essere utilizzata per dati a livello nominale o ordinale ed è l'unica tra le tre statistiche che può essere calcolata in questi casi.\n\nLa media, d'altra parte, è una buona misura di tendenza centrale solo se la distribuzione dei dati è simmetrica, ossia se i valori sono distribuiti uniformemente a sinistra e a destra della media. Tuttavia, se ci sono valori anomali o se la distribuzione è asimmetrica, la media può essere influenzata in modo significativo e, pertanto, potrebbe non essere la scelta migliore come misura di tendenza centrale.\n\nIn queste situazioni, la mediana può fornire una misura migliore di tendenza centrale rispetto alla media poiché è meno influenzata dai valori anomali e si basa esclusivamente sul valore centrale dell'insieme di dati. Di conseguenza, la scelta tra media e mediana dipende dal tipo di distribuzione dei dati e dagli obiettivi dell'analisi.\n\n## Indici di Dispersione\n\nLe misure di posizione descritte in precedenza, come le medie e gli indici di posizione, offrono una sintesi dei dati mettendo in evidenza la tendenza centrale delle osservazioni. Tuttavia, trascurano un aspetto importante della distribuzione dei dati: la variabilità dei valori numerici della variabile statistica. Pertanto, è essenziale completare la descrizione della distribuzione di una variabile statistica utilizzando anche indicatori che valutino la dispersione delle unità statistiche. In questo modo, otterremo una visione più completa e approfondita delle caratteristiche del campione analizzato.\n\n### Indici Basati sull’Ordinamento dei Dati\n\nPer valutare la variabilità dei dati, è possibile utilizzare indici basati sull'ordinamento dei dati. L'indice più semplice è l'intervallo di variazione, che corrisponde alla differenza tra il valore massimo e il valore minimo di una distribuzione di dati. Tuttavia, questo indice ha il limite di essere calcolato basandosi solo su due valori della distribuzione, e non tiene conto di tutte le informazioni disponibili. Inoltre, l'intervallo di variazione può essere fortemente influenzato dalla presenza di valori anomali.\n\nUn altro indice basato sull'ordinamento dei dati è la differenza interquartile, già incontrata in precedenza. Anche se questo indice utilizza più informazioni rispetto all'intervallo di variazione, presenta comunque il limite di essere calcolato basandosi solo su due valori della distribuzione, ossia il primo quartile $Q_1$ e il terzo quartile $Q_3$.\n\nPer valutare la variabilità in modo più completo, è necessario utilizzare altri indici di variabilità che tengano conto di tutti i dati disponibili. In questo modo, si otterrà una valutazione più accurata della dispersione dei valori nella distribuzione e si potranno individuare eventuali pattern o tendenze nascoste.\n\n### Varianza\n\nDate le limitazioni delle statistiche descritte in precedenza, è più comune utilizzare una misura di variabilità che tenga conto della dispersione dei dati rispetto a un indice di tendenza centrale. La varianza è la misura di variabilità più utilizzata per valutare la variabilità di una variabile statistica. Essa è definita come la media dei quadrati degli scarti $x_i - \\bar{x}$ tra ogni valore e la media della distribuzione, come segue:\n\n$$\n\\begin{equation}\nS^2 = \\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar{x})^2.\n\\end{equation}\n$$ {#eq-var-descr}\n\nLa varianza è una misura di dispersione più completa rispetto a quelle descritte in precedenza. Tuttavia, è appropriata solo nel caso di distribuzioni simmetriche ed è fortemente influenzata dai valori anomali, come altre misure di dispersione. Inoltre, la varianza è espressa in un'unità di misura che è il quadrato dell'unità di misura dei dati originali, pertanto, potrebbe non essere facilmente interpretata in modo intuitivo.\n\nCalcoliamo la varianza dei valori `math` per i dati del progetto STAR. Applicando l'equazione della varianza, otteniamo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((df$math - mean(df$math))^2) / length(df$math)\n#> [1] 1507\n```\n:::\n\n\n\n\nPiù semplicemente, possiamo usare la funzione `var()`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar(df$math) * (length(df$math) -1) / length(df$math)\n#> [1] 1507\n```\n:::\n\n\n\n\n#### Stima della Varianza della Popolazione\n\nSi noti il denominatore della formula della varianza. Nell'@eq-var-descr, ho utilizzato $n$ come denominatore (l'ampiezza campionaria, ovvero il numero di osservazioni nel campione). In questo modo, otteniamo la varianza come *statistica descrittiva* del campione. Tuttavia, è possibile utilizzare $n-1$ come denominatore alternativo:\n\n$$\n\\begin{equation}\ns^2 = \\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar{x})^2\n\\end{equation}\n$$ {#eq-var-stimatore}\n\nIn questo secondo caso, otteniamo la varianza come *stimatore* della varianza della popolazione. Si può dimostrare che l'@eq-var-stimatore fornisce una stima corretta (ovvero, non distorta) della varianza della popolazione da cui abbiamo ottenuto il campione, mentre l'@eq-var-descr fornisce (in media) una stima troppo piccola della varianza della popolazione. Si presti attenzione alla notazione: $S^2$ rappresenta la varianza come statistica descrittiva, mentre $s^2$ rappresenta la varianza come stimatore.\n\nPer illustrare questo punto, svolgiamo una simulazione. Consideriamo la distribuzione dei punteggi del quoziente di intelligenza (QI). I valori del QI seguono una particolare distribuzione chiamata *distribuzione normale*, con media 100 e deviazione standard 15. La forma di questa distribuzione è illustrata nella figura seguente.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define parameters\nx <- seq(100 - 4 * 15, 100 + 4 * 15, by = 0.001)\nmu <- 100\nsigma <- 15\n\n# Compute the PDF\npdf <- dnorm(x, mean = mu, sd = sigma)\n\n# Plot using ggplot2\ndata <- tibble(x = x, pdf = pdf)\nggplot(data, aes(x = x, y = pdf)) +\n  geom_line() +\n  labs(\n    x = \"QI\", \n    y = \"Densità\", \n    title = \"Distribuzione del QI nella popolazione\"\n  ) \n```\n\n::: {.cell-output-display}\n![](07_loc_scale_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n\n\n\nSupponiamo di estrarre un campione casuale di 4 osservazioni dalla popolazione del quoziente di intelligenza -- in altre parole, supponiamo di misurare il quoziente di intelligenza di 4 persone prese a caso dalla popolazione.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123) \nx <- rnorm(4, mean = 100, sd = 15)\nprint(x)\n#> [1]  91.6  96.5 123.4 101.1\n```\n:::\n\n\n\n\nCalcoliamo la varianza usando $n$ al denominatore. Si noti che la vera varianza del quoziente di intelligenza è $15^2$ = 225.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar(x)\n#> [1] 197\n```\n:::\n\n\n\n\nConsideriamo ora 10 campioni casuali del QI, ciascuno di ampiezza 4.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 100\nsigma <- 15\nsize <- 4\nniter <- 10\nrandom_samples <- list()\n\nset.seed(123) \n\nfor (i in 1:niter) {\n  one_sample <- rnorm(size, mean = mu, sd = sigma)\n  random_samples[[i]] <- one_sample\n}\n```\n:::\n\n\n\n\nIl primo campione è\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrandom_samples[1]\n#> [[1]]\n#> [1]  91.6  96.5 123.4 101.1\n```\n:::\n\n\n\n\nIl decimo campione è\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrandom_samples[10]\n#> [[1]]\n#> [1] 108.3  99.1  95.4  94.3\n```\n:::\n\n\n\n\nStampiamo i valori di tutti i 10 campioni.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrs <- do.call(rbind, random_samples)\nrs\n#>        [,1]  [,2]  [,3]  [,4]\n#>  [1,]  91.6  96.5 123.4 101.1\n#>  [2,] 101.9 125.7 106.9  81.0\n#>  [3,]  89.7  93.3 118.4 105.4\n#>  [4,] 106.0 101.7  91.7 126.8\n#>  [5,] 107.5  70.5 110.5  92.9\n#>  [6,]  84.0  96.7  84.6  89.1\n#>  [7,]  90.6  74.7 112.6 102.3\n#>  [8,]  82.9 118.8 106.4  95.6\n#>  [9,] 113.4 113.2 112.3 110.3\n#> [10,] 108.3  99.1  95.4  94.3\n```\n:::\n\n\n\n\nPer ciascun campione (ovvero, per ciascuna riga della matrice\nprecedente), calcoliamo la varianza usando la formula con $n$ al denominatore.\nOtteniamo così 10 stime della varianza della popolazione del QI.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_var <- apply(rs, 1, var)  # Applica la funzione var su ciascuna riga\nprint(x_var)\n#>  [1] 196.94 337.54 168.55 218.68 333.48  34.52 264.38 234.08   1.97  40.47\n```\n:::\n\n\n\n\nNotiamo due cose: \n\n- le stime sono molto diverse tra loro; questo fenomeno è noto con il nome di *variabilità campionaria*;\n- in media le stime sono troppo piccole.\n\nPer aumentare la sicurezza riguardo al secondo punto menzionato in precedenza, ripeteremo la simulazione utilizzando un numero di iterazioni maggiore.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- 100\nsigma <- 15\nsize <- 4\nniter <- 10000\nrandom_samples <- list()\n\nset.seed(123) # Replace 123 with your desired seed for reproducibility\n\nfor (i in 1:niter) {\n  one_sample <- rnorm(size, mean = mu, sd = sigma)\n  random_samples[[i]] <- one_sample\n}\n\nrs <- do.call(rbind, random_samples)\nx_var <- apply(rs, 1, var) * (size - 1) / size  # Adjust for population variance (ddof = 0)\n```\n:::\n\n\n\n\nEsaminiamo la distribuzione dei valori ottenuti.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a data frame for plotting\ndata <- data.frame(x_var = x_var)\n\n# Plot the histogram using ggplot2\nggplot(data, aes(x = x_var)) +\n  geom_histogram(alpha = 0.5, fill = \"blue\") +\n  labs(\n    x = \"Varianza\", \n    y = \"Frequenza\", \n    title = \"Varianza del QI in campioni di n = 4\"\n  )\n#> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n::: {.cell-output-display}\n![](07_loc_scale_files/figure-html/unnamed-chunk-25-1.png){width=576}\n:::\n:::\n\n\n\n\nLa stima più verosimile della varianza del QI è dato dalla media di\nquesta distribuzione.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(x_var)\n#> [1] 169\n```\n:::\n\n\n\n\nSi noti che il nostro spospetto è stato confermato: il valore medio della stima della varianza ottenuta con l'@eq-var-descr è troppo piccolo rispetto al valore corretto di $15^2 = 225$. \n\nRipetiamo ora la simulazione usando la formula della varianza con $n-1$ al denominatore.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123) \n\nmu <- 100\nsigma <- 15\nsize <- 4\nniter <- 10000\nrandom_samples <- list()\n\nfor (i in 1:niter) {\n  one_sample <- rnorm(size, mean = mu, sd = sigma)\n  random_samples[[i]] <- one_sample\n}\n\nrs <- do.call(rbind, random_samples)\nx_var <- apply(rs, 1, var)  # ddof = 1 is default for var in R\n\nmean(x_var)\n#> [1] 225\n```\n:::\n\n\n\n\nNel secondo caso, se utilizziamo $n-1$ come denominatore per calcolare la stima della varianza, il valore atteso di questa stima è molto vicino al valore corretto di 225. Se il numero di campioni fosse infinito, i due valori sarebbero identici.\n\nIn conclusione, le due formule della varianza hanno scopi diversi. La formula della varianza con $n$ al denominatore viene utilizzata come statistica descrittiva per descrivere la variabilità di un particolare campione di osservazioni. D'altro canto, la formula della varianza con $n-1$ al denominatore viene utilizzata come stimatore per ottenere la migliore stima della varianza della popolazione da cui quel campione è stato estratto.\n\n### Deviazione standard\n\nPer interpretare la varianza in modo più intuitivo, si può calcolare la deviazione standard (o scarto quadratico medio o scarto tipo) prendendo la radice quadrata della varianza. La deviazione standard è espressa nell'unità di misura originaria dei dati, a differenza della varianza che è espressa nel quadrato dell'unità di misura dei dati. La deviazione standard fornisce una misura della dispersione dei dati attorno alla media, rendendo più facile la comprensione della variabilità dei dati.\n\nLa deviazione standard (o scarto quadratico medio, o scarto tipo) è definita come:\n\n$$\ns^2 = \\sqrt{(n-1)^{-1} \\sum_{i=1}^n (x_i - \\bar{x})^2}.\n$$ {#eq-sd-stimatore}\n\nQuando tutte le osservazioni sono uguali, $s = 0$, altrimenti $s > 0$.\n\n::: {.callout-note}\nIl termine *standard deviation* è stato introdotto in statistica da Pearson nel 1894 assieme alla lettera greca $\\sigma$ che lo rappresenta. Il termine italiano \"deviazione standard\" ne è la traduzione più utilizzata nel linguaggio comune; il termine dell’[Ente Nazionale Italiano di Unificazione](https://it.wikipedia.org/wiki/Ente_nazionale_italiano_di_unificazione) è tuttavia “scarto tipo”, definito come la radice quadrata positiva della varianza.\n:::\n\nLa deviazione standard $s$ dovrebbe essere utilizzata solo quando la media è una misura appropriata per descrivere il centro della distribuzione, ad esempio nel caso di distribuzioni simmetriche. Tuttavia, è importante tener conto che, come la media $\\bar{x}$, anche la deviazione standard è fortemente influenzata dalla presenza di dati anomali, ovvero pochi valori che si discostano notevolmente dalla media rispetto agli altri dati della distribuzione. In presenza di dati anomali, la deviazione standard può risultare ingannevole e non rappresentare accuratamente la variabilità complessiva della distribuzione. Pertanto, è fondamentale considerare attentamente il contesto e le caratteristiche dei dati prima di utilizzare la deviazione standard come misura di dispersione. In alcune situazioni, potrebbe essere più appropriato ricorrere a misure di dispersione robuste o ad altre statistiche descrittive per caratterizzare la variabilità dei dati in modo più accurato e affidabile.\n\nPer fare un esempio, calcoliamo la deviazione standard per i valori `math` del campione di dati del progetto STAR. Applicando l'@eq-sd-stimatore, per tutto il campione abbiamo\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(df$math)\n#> [1] 38.8\n```\n:::\n\n\n\n\nPer ciascun gruppo, abbiamo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  group_by(graduated) |> \n  summarise(std_math = sd(math, na.rm = TRUE)) \n#> # A tibble: 2 × 2\n#>   graduated std_math\n#>       <int>    <dbl>\n#> 1         0     34.1\n#> 2         1     38.1\n```\n:::\n\n\n\n\n#### Interpretazione\n\nLa deviazione standard può essere interpretata in modo semplice: essa rappresenta la dispersione dei dati rispetto alla media aritmetica. È simile allo scarto semplice medio campionario, cioè alla media aritmetica dei valori assoluti degli scarti tra ciascuna osservazione e la media, anche se non è identica. La deviazione standard ci fornisce un'indicazione di quanto, in media, le singole osservazioni si discostino dal centro della distribuzione.\n\nPer verificare l'interpretazione della deviazione standard, utilizziamo i valori `math` del campione di dati del progetto STAR.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(df$math)\n#> [1] 38.8\n```\n:::\n\n\n\n\nLa deviazione standard calcolata per questi dati è $\\approx 38.8$. Questo valore ci indica che, in media, ogni osservazione si discosta di circa 38.8 punti dalla media aritmetica dei punteggi `math`. Maggiore è il valore della deviazione standard, maggiore è la dispersione dei dati attorno alla media, mentre un valore più piccolo indica che i dati sono più concentrati vicino alla media. La deviazione standard ci offre quindi una misura quantitativa della variabilità dei dati nella distribuzione.\n\nPer questi dati, lo scarto semplice medio campionario è\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(abs(df$math - mean(df$math, na.rm = TRUE)), na.rm = TRUE)\n#> [1] 31\n```\n:::\n\n\n\n\nSi noti che i due valori sono simili, ma non identici.\n\n### Deviazione Mediana Assoluta\n\nUna misura robusta della dispersione statistica di un campione è la *deviazione mediana assoluta* (*Median Absolute Deviation*, MAD) definita come la mediana del valore assoluto delle deviazioni dei dati dalla mediana. Matematicamente, la formula per calcolare la MAD è:\n\n$$\n\\text{MAD} = \\text{median} \\left( |X_i - \\text{median}(X)| \\right) \n$$ {#eq-mad-def}\n\nLa deviazione mediana assoluta è particolarmente utile quando si affrontano distribuzioni con presenza di dati anomali o asimmetrie, poiché è meno influenzata da questi valori estremi rispetto alla deviazione standard.\n\nQuando i dati seguono una distribuzione gaussiana (normale), esiste una relazione specifica tra MAD e la deviazione standard (si veda il Capitolo {ref}`cont-rv-distr-notebook`). In una distribuzione normale, la MAD è proporzionale alla deviazione standard. La costante di proporzionalità dipende dalla forma esatta della distribuzione normale, ma in generale, la relazione è data da:\n\n$$ \n\\sigma \\approx k \\times \\text{MAD},\n$$\n\ndove:\n\n- $\\sigma$ è la deviazione standard.\n- MAD è la Mediana della Deviazione Assoluta.\n- $k$ è una costante che, per una distribuzione normale, è tipicamente presa come circa 1.4826.\n\nQuesta costante di 1.4826 è derivata dal fatto che, in una distribuzione normale, circa il 50% dei valori si trova entro 0.6745 deviazioni standard dalla media. Quindi, per convertire la MAD (basata sulla mediana) nella deviazione standard (basata sulla media), si usa il reciproco di 0.6745, che è approssimativamente 1.4826.\n\nLa formula completa per convertire la MAD in una stima della deviazione standard in una distribuzione normale è:\n\n$$ \n\\sigma \\approx 1.4826 \\times \\text{MAD} \n$$\n\nQuesta relazione è utile per stimare la deviazione standard in modo più robusto, specialmente quando si sospetta la presenza di outlier o si ha a che fare con campioni piccoli. Di conseguenza, molti software restituiscono il valore MAD moltiplicato per questa costante per fornire un'indicazione più intuitiva della variabilità dei dati. Tuttavia, è importante notare che questa relazione si mantiene accurata solo per le distribuzioni che sono effettivamente normali. In presenza di distribuzioni fortemente asimmetriche o con elevati outlier, la deviazione standard e la MAD possono fornire indicazioni molto diverse sulla variabilità dei dati.\n\nPer verificare questo principio, calcoliamo la deviazione mediana assoluta dei valori `math` del campione di dati del progetto STAR.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1.4826 * median(abs(df$math - median(df$math, na.rm = TRUE)), na.rm = TRUE)\n#> [1] 41.5\n```\n:::\n\n\n\n\nIn questo caso, la MAD per i punteggi di matematica è simile alla deviazione standard.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(df$math)\n#> [1] 38.8\n```\n:::\n\n\n\n\nInfatti, la distribuzione dei punteggi `math` è approssimativamente gaussiana.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = math)) +\n  geom_density(alpha = 0.5) +\n  labs(\n    x = \"math\", \n    y = \"Frequenza\", \n    title = \"Distribuzione dei Punteggi di Matematica\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_loc_scale_files/figure-html/unnamed-chunk-34-1.png){width=576}\n:::\n:::\n\n\n\n\nVerifichiamo nuovamente il principio usando un campione di dati estratto da una popolazione normale. Usiamo, ad esempio, la distribuzione $\\mathcal{N}(100, 15)$:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123) \nx <- rnorm(10000, mean = 100, sd = 15)\n1.4826 * median(abs(x - median(x)))\n#> [1] 14.9\n```\n:::\n\n\n\n\n### Quando Usare Deviazione Standard e MAD\n\nLa deviazione standard e la MAD sono entrambe misure di dispersione che forniscono informazioni su quanto i dati in un insieme si discostano dalla tendenza centrale. Tuttavia, ci sono alcune differenze tra le due misure e situazioni in cui può essere più appropriato utilizzare una rispetto all'altra.\n\n- Deviazione standard: Questa misura è particolarmente utile per descrivere la dispersione dei dati in una distribuzione normale. La deviazione standard è una scelta appropriata se si vuole sapere quanto i dati sono distribuiti intorno alla media, o se si vuole confrontare la dispersione di due o più set di dati. Tuttavia, la deviazione standard è fortemente influenzata dalla presenza di dati anomali, e questo può rappresentare una limitazione in casi in cui sono presenti valori estremi nell'insieme di dati.\n\n- Deviazione mediana assoluta (MAD): La MAD è meno sensibile ai valori anomali rispetto alla deviazione standard, il che la rende una scelta migliore quando ci sono valori anomali nell'insieme di dati. Inoltre, la MAD può essere una buona scelta quando si lavora con dati non normalmente distribuiti, poiché non assume una distribuzione specifica dei dati. La MAD è calcolata utilizzando la mediana e i valori assoluti delle deviazioni dei dati dalla mediana, il che la rende una misura robusta di dispersione.\n\nIn sintesi, se si sta lavorando con dati normalmente distribuiti, la deviazione standard è la misura di dispersione più appropriata. Se si lavora con dati non normalmente distribuiti o si hanno valori anomali nell'insieme di dati, la MAD può essere una scelta migliore. In ogni caso, la scelta tra le due misure dipende dal tipo di dati che si sta analizzando e dall'obiettivo dell'analisi.\n\n### Indici di Variabilità Relativi\n\nA volte può essere necessario confrontare la variabilità di grandezze incommensurabili, ovvero di caratteri misurati con differenti unità di misura. In queste situazioni, le misure di variabilità descritte in precedenza diventano inadeguate poiché dipendono dall'unità di misura utilizzata. Per superare questo problema, si ricorre a specifici numeri adimensionali chiamati *indici relativi di variabilità*.\n\nIl più importante di questi indici è il *coefficiente di variazione* ($C_v$), definito come il rapporto tra la deviazione standard ($\\sigma$) e la media dei dati ($\\bar{x}$):\n\n$$\nC_v = \\frac{\\sigma}{\\bar{x}}.\n$$ {#eq-cv-def}\n\nIl coefficiente di variazione è un numero puro e permette di confrontare la variabilità di distribuzioni con unità di misura diverse.\n\nUn altro indice relativo di variabilità è la *differenza interquartile rapportata* a uno dei tre quartili (primo quartile, terzo quartile o mediana). Questo indice è definito come:\n\n$$\n\\frac{x_{0.75} - x_{0.25}}{x_{0.25}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.75}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.50}}.\n$$\n\nQuesti indici relativi di variabilità forniscono una misura adimensionale della dispersione dei dati, rendendo possibile il confronto tra grandezze con diverse unità di misura e facilitando l'analisi delle differenze di variabilità tra i dati.\n\n## La Fallacia Ergodica\n\nSebbene il concetto di \"media\" possa sembrare chiaro, ciò non implica che il suo utilizzo non presenti delle problematiche nell'ambito della pratica psicologica. Un aspetto su cui vale la pena soffermarsi è ciò che viene definito \"fallacia ergodica\".\n\nIl concetto di \"fallacia ergodica\" [@speelman2024most] si riferisce all'errore compiuto dai ricercatori quando assumono che le caratteristiche medie di un gruppo di individui possano essere applicate a ciascun individuo all'interno di quel gruppo, senza considerare le differenze individuali o le variazioni nel tempo. Questa fallacia emerge dalla pratica comune nella ricerca psicologica di raccogliere dati aggregati da gruppi di persone per stimare parametri della popolazione, al fine di confrontare comportamenti in condizioni diverse o esplorare associazioni tra diverse misurazioni della stessa persona.\n\nIl problema di questo approccio è che l'uso dei risultati basati sul gruppo per caratterizzare le caratteristiche degli individui o per estrapolare a persone simili a quelle del gruppo è ingiustificato, poiché le medie di gruppo possono fornire informazioni solo sui risultati collettivi, come la performance media del gruppo, e non consentono di fare affermazioni accurate sugli individui che compongono quel gruppo. La fallacia ergodica si basa sull'assunzione che per utilizzare legittimamente una statistica aggregata (ad esempio, la media) derivata da un gruppo per descrivere un individuo di quel gruppo, due condizioni devono essere soddisfatte: gli individui devono essere così simili da essere praticamente interscambiabili, e le caratteristiche degli individui devono essere temporalmente stabili.\n\nTuttavia, i fenomeni e i processi psicologici di interesse per i ricercatori sono per natura non uniformi tra gli individui e variabili nel tempo, sia all'interno degli individui che tra di loro. Di conseguenza, i risultati ottenuti dalla media di misure di comportamenti, cognizioni o stati emotivi di più individui non descrivono accuratamente nessuno di quegli individui in un dato momento, né possono tenere conto dei cambiamenti in quelle variabili per un individuo nel tempo.\n\n@speelman2024most osservano che la stragrande maggioranza degli articoli che hanno analizzato include conclusioni nelle sezioni degli Abstract e/o delle Discussioni che implicano che i risultati trovati con dati aggregati di gruppo si applichino anche agli individui in quei gruppi e/o si applichino agli individui nella popolazione. Questa pratica riflette la fallacia ergodica, che consiste nell'assumere che i campioni siano sistemi ergodici quando non lo sono.\n\n## Riflessioni Conclusive\n\nLe statistiche descrittive ci permettono di ottenere indicatori sintetici che riassumono i dati di una popolazione o di un campione estratto da essa. Questi indicatori includono misure di tendenza centrale, come la media, la mediana e la moda, che ci forniscono informazioni sulla posizione centrale dei dati rispetto alla distribuzione. Inoltre, ci sono gli indici di dispersione, come la deviazione standard e la varianza, che ci indicano quanto i dati si disperdono attorno alla tendenza centrale. Questi indici ci aiutano a comprendere quanto i valori si discostano dalla media, e quindi ci forniscono un'idea della variabilità dei dati. In conclusione, le statistiche descrittive ci offrono un quadro sintetico delle caratteristiche principali dei dati, consentendoci di comprendere meglio la loro distribuzione e variabilità.\n\n## Informazioni sull'Ambiente di Sviluppo {.unnumbered}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.4.2 (2024-10-31)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.2\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] grid      stats     graphics  grDevices utils     datasets  methods  \n#> [8] base     \n#> \n#> other attached packages:\n#>  [1] vcd_1.4-13        viridis_0.6.5     viridisLite_0.4.2 gridExtra_2.3    \n#>  [5] patchwork_1.3.0   bayesplot_1.11.1  psych_2.4.6.26    scales_1.3.0     \n#>  [9] markdown_1.13     knitr_1.49        lubridate_1.9.4   forcats_1.0.0    \n#> [13] stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2       readr_2.1.5      \n#> [17] tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0  \n#> [21] rio_1.2.3         here_1.0.1       \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] utf8_1.2.4        generics_0.1.3    stringi_1.8.4     lattice_0.22-6   \n#>  [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.1   \n#>  [9] timechange_0.3.0  fastmap_1.2.0     R.oo_1.27.0       rprojroot_2.0.4  \n#> [13] jsonlite_1.8.9    R.utils_2.12.3    fansi_1.0.6       mnormt_2.1.1     \n#> [17] cli_3.6.3         rlang_1.1.4       R.methodsS3_1.8.2 munsell_0.5.1    \n#> [21] withr_3.0.2       tools_4.4.2       parallel_4.4.2    tzdb_0.4.0       \n#> [25] colorspace_2.1-1  pacman_0.5.1      vctrs_0.6.5       R6_2.5.1         \n#> [29] zoo_1.8-12        lifecycle_1.0.4   htmlwidgets_1.6.4 MASS_7.3-61      \n#> [33] pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.6      data.table_1.16.4\n#> [37] glue_1.8.0        lmtest_0.9-40     xfun_0.49         tidyselect_1.2.1 \n#> [41] farver_2.1.2      htmltools_0.5.8.1 nlme_3.1-166      labeling_0.4.3   \n#> [45] rmarkdown_2.29    compiler_4.4.2\n```\n:::\n\n\n\n\n## Bibliografia {.unnumbered}\n\n\n",
    "supporting": [
      "07_loc_scale_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}