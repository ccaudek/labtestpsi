{
  "hash": "c27cb8468330226a9622e6584bd9ab43",
  "result": {
    "engine": "knitr",
    "markdown": "# Interazioni statistiche\n\n\n**Prerequisiti**\n\n- Leggere *Understanding ‘it depends’ in ecology: a guide to hypothesising, visualising and interpreting statistical interactions* [@spake2023understanding] focalizzandosi sulla sezione *The domination of the collective: the example of mediation and moderation*.\n- Leggere *The role of the individual in the coming era of process-based therapy* [@hayes2019role].\n\n**Concetti e competenze chiave**\n\n- Le relazioni tra variabili psicologiche possono variare in base a diversi fattori o condizioni, rendendo queste relazioni \"dipendenti dal contesto\".\n- *Errore di Tipo D (dipendenza dal contesto non rilevata)*: Quando un'analisi statistica non riesce a rilevare la dipendenza dal contesto a causa della scala di misura scelta.\n- *Errore di Tipo S (significato modificato)*: Quando la scala di modellizzazione cambia l'interpretazione di un'interazione statistica.\n- *Errore di Tipo A (esplorazione asimmetrica)*: Quando l'analisi delle interazioni considera solo una direzione della relazione, ignorando la possibile bidirezionalità dell'effetto.\n- *Condizionamento*: La pratica di controllare o considerare l'influenza di una variabile nel contesto di un modello, spesso usata per interpretare le interazioni.\n- L'importanza di comprendere le relazioni causali sottostanti quando si interpretano le interazioni statistiche, per evitare errori inferenziali.\n- Le sfide nell'analisi di potenza per le interazioni, che richiedono spesso campioni molto grandi a causa della complessità e della natura sottile degli effetti interattivi.\n- La necessità di scegliere la scala di misura appropriata (additiva o moltiplicativa) per interpretare correttamente le interazioni statistiche.\n\n::: callout-caution\n## Preparazione del Notebook\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> \n  source()\n\n# Load packages\nif (!requireNamespace(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(readr)\n```\n:::\n\n\n\n:::\n\n## Introduzione \n\nNel campo della psicologia, la complessità e la natura multi-causale dei fenomeni psicologici spesso portano i ricercatori a descrivere le relazioni tra variabili come \"dipendenti dal contesto\" [@spake2023understanding]. Questo significa che le associazioni tra variabili possono variare in base a diversi fattori o condizioni. Un concetto chiave in questo ambito è l'**interazione statistica**, che si verifica quando l'effetto di una variabile indipendente su una variabile dipendente cambia in base al livello di un'altra variabile indipendente.\n\nAd esempio, in un recente studio di @Pines2024, è stato osservato che le relazioni tra cognizione e salute mentale nei bambini possono essere sia positive che negative, a seconda del contesto. In particolare, la relazione tra cognizione e salute mentale varia significativamente in base alla popolazione studiata. Se si considerano bambini generalmente sani con pochi sintomi isolati, potrebbe emergere una relazione diversa rispetto a un campione di bambini con sintomi di gravità clinica.\n\nNello studio di @Pines2024, è stato evidenziato che la direzione della relazione tra cognizione e salute mentale nei bambini cambia in modo significativo a seconda della gravità dei sintomi. Per i sintomi internalizzanti (come ansia e depressione), si è osservato che i bambini con pochi sintomi tendono ad avere punteggi cognitivi più alti rispetto ai bambini senza sintomi, mentre i bambini con sintomi gravi mostrano una cognizione compromessa. Questo cambiamento nella direzione della relazione, a seconda della gravità dei sintomi, rappresenta un esempio di interazione statistica.\n\nPer quanto riguarda i sintomi esternalizzanti (come comportamenti aggressivi), la pendenza della relazione tra cognizione e salute mentale può variare a seconda della gravità dei sintomi, ma la direzione dell'associazione rimane invariata.\n\nQuesto esempio dimostra che, quando si parla di interazioni statistiche, è fondamentale considerare come il contesto e le caratteristiche specifiche dei partecipanti possano influenzare le relazioni tra le variabili. @Pines2024 sottolineano che, se l'obiettivo dello studio è comprendere il ruolo della cognizione nella psicopatologia, è essenziale includere individui con sintomi di gravità clinica. Questo perché le relazioni osservate in campioni sani potrebbero non solo non generalizzarsi a campioni clinici, ma potrebbero anche mostrare associazioni opposte.\n\nIn sintesi, l'interazione statistica ci aiuta a comprendere come le relazioni tra variabili possano cambiare a seconda delle condizioni o dei gruppi specifici, evidenziando l'importanza di un approccio attento e contestualizzato nella ricerca psicologica. Studiare le dipendenze tra i fattori psicologici ha sia motivazioni pratiche che teoriche. Ad esempio, identificare effetti interattivi può aiutare a indirizzare le risorse di intervento in contesti in cui queste saranno più efficaci, mentre l'assenza di interazioni potrebbe suggerire l'esistenza di relazioni generali in uno specifico dominio psicologico.\n\n@spake2023understanding si chiede se un fattore di interesse abbia un effetto che \"dipende da\" o viene \"modificato\" in magnitudine o segno da altri fattori. Potrebbe sembrare che la risposta a questa domanda sia semplice utilizzando mezzi grafici come i grafici condizionali (valori previsti di Y tracciati lungo l'intervallo di X e Z, o a valori significativi di questi predittori) o esaminando gli effetti marginali (gli effetti marginali riassumono l'effetto di una variabile indipendente sulla risposta in termini di previsioni di un modello). Tuttavia, tali analisi sono vulnerabili a diverse potenziali interpretazioni errate, che emergono quando si trascurano due aspetti critici della modifica dell'effetto: la scala (se una risposta è analizzata su una scala additiva o moltiplicativa) e la simmetria (se la modifica dell'effetto è esaminata in entrambe le direzioni).\n\nNel loro articolo, @spake2023understanding analizzano gli errori inferenziali che possono sorgere quando la scala e la simmetria della modifica dell'effetto vengono trascurate negli studi di ricerca. Iniziano illustrando con dati empirici e simulazioni come gli errori di tipo D, S e A possano derivare dall'ignorare la scala e la simmetria delle interazioni, anche quando un modello è correttamente specificato.\n\n## La dipendenza dal contesto può passare inosservata (Errore di Tipo D)\n\nIl modo più comune per testare la dipendenza dal contesto è introdurre un'interazione statistica (X × Z) in un modello. Le interazioni statistiche indicano che la relazione tra X e Y varia lungo l'intervallo di Z; analogamente, le relazioni Z–Y variano lungo l'intervallo di X (Duncan & Kefford, 2021). Il supporto statistico per un'interazione è poi determinato, ad esempio, utilizzando criteri di selezione del modello per giustificarne l'inclusione in modelli concorrenti (ad esempio, il criterio di informazione di Akaike, AIC).\n\nTuttavia, il fatto che un termine di interazione sia supportato o meno può dipendere criticamente dalla scala di misura utilizzata per stimare gli effetti in un modello statistico, ovvero se la scala di misura è additiva (ad esempio, unità assolute) o moltiplicativa (ad esempio, log-trasformata).\n\n![**Tre errori inferenziali comuni nell'investigazione della dipendenza dal contesto.** Consideriamo un test di dipendenza dal contesto nella sua forma più semplice: un esperimento fattoriale 2 × 2, che misura una risposta Y in relazione all'incrocio dei fattori X e Z, ciascuno con due livelli. L'analista adatta ai dati un modello statistico con un termine di interazione: \\(Y \\sim X + Z + X \\times Z\\), per testare e quantificare la dipendenza dal contesto. Sono possibili tre errori inferenziali quando si trascurano la scala di misurazione o la simmetria dell'interazione: la rilevazione e la grandezza (Tipo D), il segno (Tipo S) e la mancata identificazione dei processi sottostanti (Tipo A) (figura tratta da @spake2023understanding).](../../figures/interactions_errors.png){ width=90% }\n\n## Mediazione e moderazione\n\nL’articolo di Baron e Kenny (1986) ha rappresentato un punto di riferimento fondamentale per l’analisi della mediazione e della moderazione, influenzando numerosi studi successivi. In questo lavoro, gli autori hanno descritto il mediatore come il meccanismo attraverso il quale la variabile indipendente principale esercita un effetto sulla variabile dipendente di interesse (Baron & Kenny, 1986, p. 1173). In altre parole, il mediatore spiega \"come\" o \"perché\" si verifica questa relazione. D'altra parte, hanno definito il moderatore come una variabile che altera l’intensità o la direzione della relazione tra la variabile indipendente e la variabile dipendente (Baron & Kenny, 1986, p. 1174). Il moderatore ci dice \"quando\" o \"in quali condizioni\" si verifica l'effetto.\n\nSi parla di mediazione completa quando il legame tra due variabili, A e C, viene eliminato dopo aver controllato per il mediatore B (Baron & Kenny, 1986). Se, invece, la variabile A continua ad avere un effetto diretto su C, oltre a quello indiretto mediato da B, si ha una mediazione parziale (James & Brett, 1984).\n\nPer studiare mediatori e moderatori, si utilizzano spesso tecniche come l'analisi della varianza (ANOVA), i modelli di regressione e i modelli a equazioni strutturali (SEM) (Baron & Kenny, 1986; Holmbeck, 1997; Judd & Kenny, 1981). Questi metodi sono progettati per indagare la direzione causale degli effetti mediatori (Smith, 1982), distinguere tra mediazione completa e parziale (Holmbeck, 1997; Sobel, 1982), e anche testare modelli che combinano sia mediazione che moderazione (Baron & Kenny, 1986).\n\nÈ importante sottolineare che, così come vengono comunemente condotte, queste analisi presentano notevoli limitazioni nell'informare un approccio basato sui processi per spiegare i fenomeni psicologici [@hayes2019role]. I concetti di mediazione completa e parziale riguardano inferenze sui parametri di popolazione, ma non possono essere estesi ai singoli partecipanti di uno studio, né applicati alle persone, e nemmeno riferiti alle cause specifiche che operano a livello individuale [@grice2015muddled].\n\n### Le interazioni statistiche dipendono dalla scala di misura\n\nUn altro problema relativo alle interazioni riguarda la loro stessa misurazione [@spake2023understanding]. Le interazioni statistiche, come quelle osservate in un esperimento fattoriale 2x2, sono influenzate dalla scala di misura utilizzata. La rilevazione di un'interazione dipende dal fatto che le linee di un grafico di interazione (che connettono le medie di uno stesso livello di un fattore attraverso i livelli di un altro) siano parallele o meno. Tuttavia, il grado di divergenza dal parallelismo può variare a seconda della scala di misura adottata. Se X e Z influenzano Y in modo indipendente, allora:\n\n- Se non c'è una modifica nell'effetto assoluto di X su Y con diversi valori di Z (cioè, le linee sono parallele su una scala additiva), allora l'effetto relativo di X su Y varierà con Z (le linee non saranno parallele su una scala moltiplicativa).\n- Al contrario, se l'effetto relativo di X su Y rimane costante per diversi valori di Z (cioè, le linee sono parallele su una scala moltiplicativa), allora l'effetto assoluto di X su Y cambierà con Z su una scala additiva.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Funzione per generare i dati\ngenera_dati <- function(n_per_gruppo = 100) {\n  set.seed(42)  # Equivalente di np.random.seed(42)\n  \n  # Inizializzare un data frame vuoto\n  data <- data.frame(X = numeric(), Z = numeric(), Y = numeric())\n  \n  # Ciclo esterno per X (0 e 1)\n  for (x in c(0, 1)) {\n    # Ciclo interno per Z (0 e 1)\n    for (z in c(0, 1)) {\n      # Generare y con distribuzione normale\n      y <- 10 + 5 * x + 8 * z + rnorm(n_per_gruppo, mean = 0, sd = 0.5)\n      \n      # Creare un sotto-dataframe per questa combinazione di X e Z\n      temp_df <- data.frame(\n        X = rep(x, n_per_gruppo),\n        Z = rep(z, n_per_gruppo),\n        Y = y\n      )\n      \n      # Aggiungere al dataframe principale\n      data <- rbind(data, temp_df)\n    }\n  }\n  \n  return(data)\n}\n\n# Funzione per creare il grafico di interazione\nplot_interazione <- function(data, y_col, title) {\n  # Controlli sui parametri di input\n  if (!is.data.frame(data)) {\n    stop(\"Il primo argomento deve essere un data frame\")\n  }\n  \n  if (!y_col %in% names(data)) {\n    stop(paste(\"La colonna\", y_col, \"non esiste nel data frame\"))\n  }\n  \n  # Assicurarsi che Z sia trattata come fattore\n  data$Z <- as.factor(data$Z)\n  \n  # Creazione del grafico con ggplot2\n  ggplot(data, aes(x = X, y = .data[[y_col]], color = Z, group = Z)) +\n    geom_line(linewidth = 1.2) +\n    geom_point(size = 3) +\n    labs(\n      title = title, \n      color = \"Z\", \n      x = \"X\", \n      y = y_col\n    ) +\n    theme(legend.position = \"top\") +\n    scale_color_manual(values = c(\"#1E90FF\", \"#FF4500\"))  # Colori più eleganti\n}\n\n# Genera il dataframe\ndf <- genera_dati()\n\n# Grafico sulla scala originale\nplot_interazione(df, \"Y\", \"Interazione sulla Scala Originale (Additiva)\")\n```\n\n::: {.cell-output-display}\n![](07_interactions_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n\n\nNella simulazione presentata, osserviamo due scenari chiave:\n\n1. Scala Originaria (Additiva):\n   - I dati sulla scala originaria non mostrano interazione.\n   - Le linee nel grafico sono parallele, indicando che l'effetto di X su Y è costante per diversi livelli di Z.\n   - Questo parallelismo suggerisce che gli effetti di X e Z su Y sono additivi e indipendenti.\n\n2. Scala Trasformata (Esponenziale):\n   - Applicando una trasformazione esponenziale ai dati originari, emerge un'apparente interazione.\n   - Le linee nel grafico non sono più parallele, suggerendo che l'effetto di X su Y varia a seconda del livello di Z.\n\nÈ importante notare che:\n\n- La presenza o assenza di interazione dipende dalla scala di misura utilizzata.\n- La trasformazione non crea o elimina relazioni reali tra le variabili, ma cambia il modo in cui interpretiamo queste relazioni.\n\nConsideriamo il caso inverso:\n\n- Se il secondo grafico (con interazione apparente) rappresentasse i dati grezzi, una trasformazione logaritmica potrebbe produrre un grafico simile al primo, mostrando assenza di interazione.\n- Questo perché la funzione logaritmica è l'inversa della funzione esponenziale.\n- In generale, se abbiamo dati che mostrano interazione su una scala moltiplicativa, una trasformazione logaritmica potrebbe rivelare una relazione additiva senza interazione.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Trasformazione della variabile Y\ndf$Y_exp <- exp(df$Y / 5)\n\n# Grafico sulla scala trasformata\nplot_interazione(\n  df, \"Y_exp\", \n  \"Interazione sulla Scala Trasformata (Esponenziale)\"\n)\n```\n\n::: {.cell-output-display}\n![](07_interactions_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\n\n\n@spake2023understanding notano inoltre che esistono due tipi di interazioni:\n\n- **Interazioni non rimovibili (crossover o qualitative)**: queste coinvolgono un cambiamento nel segno di un effetto e non possono essere eliminate attraverso una trasformazione monotona della scala di misura.\n- **Interazioni rimovibili**: queste possono essere eliminate cambiando la scala di misura e sono particolarmente soggette a errori di tipo D (falsi negativi) e S (falsi positivi).\n\nIn conclusione,\n\n- la scelta della scala appropriata dovrebbe essere guidata dalla teoria sottostante e dalla natura dei dati, non solo dall'aspetto visivo dei grafici;\n- è sempre consigliabile esaminare i dati su diverse scale e considerare attentamente quale scala sia più appropriata per l'interpretazione nel contesto specifico della ricerca.\n\n## La scala di modellizzazione può cambiare il significato di un'interazione statistica (Errore di Tipo S)\n\nNel pannello B della figura di @spake2023understanding, viene mostrato come il significato di un'interazione statistica possa cambiare a seconda della scala di modellizzazione utilizzata: nel pannello di sinistra, l'effetto di Z diventa meno negativo man mano che X aumenta, mentre nel pannello di destra, l'effetto di Z diventa più negativo con l'aumentare di X.\n\nLe scale additive indicano che l'effetto combinato di due predittori è semplicemente la somma dei loro effetti individuali. Al contrario, le scale moltiplicative, spesso utilizzate nei modelli lineari generalizzati (GLM), suggeriscono che l'effetto combinato è il prodotto degli effetti individuali. Questo cambiamento nel significato dell'interazione è dovuto alla natura non lineare delle funzioni di collegamento nei GLM, il che implica che l'effetto marginale di un predittore può variare in base ai valori degli altri predittori, anche se non sono presenti termini di interazione espliciti.\n\n### Quale scala di misura è più appropriata: additiva o moltiplicativa?\n\nLa scelta tra scala additiva e moltiplicativa dipende dal contesto e dagli obiettivi dell'analisi. La scala additiva è spesso considerata più rilevante per la formulazione di politiche perché consente di valutare cambiamenti assoluti, utili per determinare l'impatto di interventi su specifici gruppi. La scala moltiplicativa è utile per comprendere processi relativi, come i tassi di crescita delle popolazioni. In molti casi, è utile presentare e interpretare entrambi i tipi di misure per fornire una comprensione completa dell'effetto di interazioni complesse. \n\nIn sintesi, le interazioni statistiche sono intrinsecamente dipendenti dalla scala di misura. La corretta interpretazione di queste interazioni richiede attenzione alla scala scelta per modellare i dati e alle implicazioni che questa scelta ha per le conclusioni inferenziali e la rilevanza pratica dei risultati ottenuti. È essenziale non basarsi solo sulla significatività statistica, ma anche considerare il significato scientifico o pratico degli effetti osservati.\n\n## Le esplorazioni asimmetriche della dipendenza dal contesto non sono sufficienti per interpretare le interazioni (Errore di Tipo A)\n\n@spake2023understanding descrivono l'errore di *Tipo A* che si verifica quando si esplorano in modo asimmetrico le dipendenze dal contesto nelle interazioni statistiche (si veda il pannello C della figura di @spake2023understanding). Ciò avviene quando si tratta una variabile come \"effetto principale\" e l'altra come \"modificatore\" senza considerare che la relazione potrebbe funzionare in entrambe le direzioni. Questo approccio può portare a una comprensione incompleta o fuorviante dei processi sottostanti.\n\nNelle ricerche psicologiche, è comune testare come un \"modificatore\" (variabile Z) influenzi l'effetto di una variabile di interesse principale (variabile X). Questo approccio è spesso giustificato perché la variabile X può essere manipolata direttamente o rappresenta una variabile di \"trattamento\", mentre Z è un contesto che non può essere facilmente cambiato. Tuttavia, visualizzare e interpretare le interazioni solo in una direzione (come l'effetto di X su Y modificato da Z) può portare a errori, poiché questa visione potrebbe non riflettere tutte le possibili relazioni condizionali tra X, Y, e Z.\n\nConsideriamo un esempio in cui studiamo l'effetto dello *stress* (X) sulla *performance cognitiva* (Y), e ipotizziamo che questo effetto sia modificato dal *supporto sociale* (Z).\n\n- **Ipotesi Asimmetrica**: Formuliamo l'ipotesi che il supporto sociale (Z) moderi l'effetto dello stress (X) sulla performance cognitiva (Y). Ci aspettiamo che con maggiore supporto sociale, lo stress abbia un impatto minore sulla performance cognitiva. Così, X (stress) è l'effetto principale e Z (supporto sociale) è il modificatore. Costruiamo un modello che include un termine di interazione (stress × supporto sociale) e visualizziamo un grafico degli effetti marginali che mostra come l'effetto dello stress sulla performance cognitiva cambi con diversi livelli di supporto sociale.\n\n  - **Risultato Potenziale**: Il grafico mostra che, con alto supporto sociale, l'effetto negativo dello stress sulla performance cognitiva è ridotto. Concludiamo che il supporto sociale può aiutare a mitigare gli effetti negativi dello stress, promuovendo quindi interventi per aumentare il supporto sociale nei contesti lavorativi.\n\n- **Ipotesi Completa**: Se esaminiamo l'interazione in modo simmetrico, potremmo anche considerare come lo stress modera l'effetto del supporto sociale sulla performance cognitiva. Questa prospettiva potrebbe rivelare, per esempio, che in condizioni di basso stress, il supporto sociale non ha alcun effetto sulla performance cognitiva, o addirittura che troppo supporto sociale in condizioni di basso stress potrebbe ridurre l'autonomia e la performance.\n\n  - **Risultato Potenziale**: Visualizzando gli effetti marginali in entrambe le direzioni (supporto sociale che modera lo stress e viceversa), scopriamo che l'effetto del supporto sociale è positivo solo sotto condizioni di stress elevato, ma negativo quando lo stress è basso. Questo ci suggerisce che promuovere il supporto sociale dovrebbe essere mirato solo a contesti di stress elevato, cambiando completamente la nostra interpretazione e le nostre raccomandazioni.\n\nIn sintesi, l'errore di Tipo A evidenzia l'importanza di esaminare le interazioni in modo simmetrico e di considerare come entrambe le variabili possano influenzarsi reciprocamente. In psicologia, ciò potrebbe significare guardare non solo come una variabile contesto influenzi un effetto principale, ma anche come l'effetto principale possa a sua volta modificare l'influenza della variabile contesto. Trascurare questa bidirezionalità può portare a conclusioni incomplete e ad interventi inefficaci.\n\n## Interazione e Condizionamento\n\n@McElreath_rethinking mette in relazione il concetto di interazione con quello di condizionamento e illustra il concetto di condizionamento utilizzando l'analogia con i bombardieri A.W.38 durante la Seconda Guerra Mondiale. Durante la guerra, i bombardieri A.W.38 della Royal Air Force erano spesso bersagliati da artiglieria e fuoco di intercettazione. Molti di questi aerei non tornavano dalle missioni, ma quelli che riuscivano a tornare portavano evidenti segni di danno. Inizialmente, sembrava logico aggiungere armature nelle aree degli aerei che mostravano più danni, come ali e fusoliera. Tuttavia, questo approccio si basava su un errore di condizionamento.\n\n*Condizionamento* significa che i dati che osserviamo (i danni sui bombardieri che sono tornati) sono condizionati dal fatto che questi bombardieri sono sopravvissuti. I bombardieri che tornavano alla base mostravano danni in parti non essenziali per il volo, come le ali. Le parti che risultavano intatte (cabina di pilotaggio e motori) erano in realtà le più critiche: se fossero state danneggiate, l'aereo non sarebbe tornato affatto. Pertanto, per migliorare la sopravvivenza dei bombardieri, si sarebbe dovuto armare le parti che non mostravano danni nei bombardieri sopravvissuti, perché queste erano le parti che, se colpite, avrebbero causato la perdita dell'aereo.\n\nIl principio del condizionamento è fondamentale per l'inferenza statistica. Indica che i dati che osserviamo sono spesso condizionati da come entrano nel nostro campione, cioè da un insieme di condizioni preesistenti. Nel caso dei bombardieri, i danni osservati sono condizionati dal fatto che l'aereo sia riuscito a tornare alla base.\n\nAnalogamente, nelle analisi statistiche, dobbiamo considerare che le distribuzioni posteriori (cioè, la probabilità di un certo parametro dato i dati osservati) sono condizionate dai dati stessi. L'inferenza basata su modelli è condizionata dal modello scelto. Ogni inferenza statistica è condizionata da qualcosa, anche se non ce ne rendiamo sempre conto.\n\nPer quel che riguarda la discussione presente, possiamo sottolineare che il condizionamento è anche alla base delle interazioni nei modelli statistici. Per esempio, se vogliamo permettere che l'associazione tra due variabili dipenda da una terza variabile, stiamo applicando un condizionamento. In un modello lineare, una *interazione* permette che l'effetto di un predittore vari in base ai valori di un altro predittore. Questo è un esempio di come un parametro può essere condizionato da ulteriori aspetti dei dati.\n\n## Interazione e nessi causali\n\n@McElreath_rethinking, nel suo libro \"Statistical Rethinking\", solleva un punto cruciale riguardo all'analisi delle interazioni statistiche. Egli sottolinea che esaminare un'interazione, ovvero valutare se l'associazione tra due variabili dipende da una terza, implica essenzialmente un processo di condizionamento. In altre parole, si tratta di \"controllare\" l'effetto di una variabile nel contesto di un modello di regressione. Tuttavia, @McElreath_rethinking avverte che la decisione di condizionare su una variabile non è sempre appropriata o sensata, ma dipende criticamente dalle relazioni causali che intercorrono tra le variabili in esame.\n\nQuesto concetto si ricollega direttamente alle discussioni sull'inferenza causale. Come è stato evidenziato nel @sec-causal-inference-regr, è fondamentale condizionare sui confondenti, ovvero quelle variabili che influenzano sia la variabile indipendente che quella dipendente. D'altra parte, è metodologicamente errato condizionare su un discendente, cioè una variabile che è influenzata dalla variabile dipendente o da quella indipendente. Questa distinzione ha implicazioni profonde per l'analisi delle interazioni.\n\nDi conseguenza, la quantificazione degli effetti dell'interazione non può essere considerata un'operazione \"statisticamente neutra\" o universalmente applicabile. La sua validità e interpretazione dipendono strettamente dalla struttura causale sottostante al fenomeno studiato. Senza una comprensione approfondita delle relazioni causali tra le variabili, l'esame delle interazioni statistiche può facilmente portare a conclusioni fuorvianti o errate. Un approccio puramente statistico, che non tenga conto del contesto causale, rischia di condurre a interpretazioni fallaci dei risultati.\n\nPer condurre un'analisi delle interazioni robusta e significativa, è quindi essenziale integrare la conoscenza specifica del dominio con i metodi statistici. Questo richiede una comprensione dettagliata dei meccanismi causali potenziali nel sistema studiato. Prima di esaminare le interazioni, è cruciale sviluppare un modello causale, anche se preliminare, delle relazioni tra le variabili. L'utilizzo di strumenti come i diagrammi causali (DAG - Directed Acyclic Graphs) può essere di grande aiuto per visualizzare e analizzare queste relazioni causali.\n\nL'approccio consigliato è quindi quello di basare l'analisi delle interazioni su ipotesi causali ben fondate, piuttosto che su pure associazioni statistiche. Questo metodo sottolinea l'importanza di una progettazione attenta degli studi e di una riflessione approfondita sulle relazioni causali prima dell'analisi dei dati. Tale approccio può portare a una rivalutazione di molte pratiche comuni nell'analisi statistica, specialmente in campi dove le relazioni causali sono complesse o non completamente comprese.\n\nIn conclusione, l'analisi delle interazioni statistiche richiede una comprensione approfondita del contesto causale. Un approccio che integra la teoria causale con l'analisi statistica è essenziale per trarre conclusioni valide e significative dalle interazioni osservate nei dati. Senza questa integrazione, l'esame delle interazioni statistiche in maniera ingenua può essere molto rischioso e potenzialmente fuorviante.\n\n## Misurare le interazioni\n\nUna caratteristica fondamentale di una buona pratica di ricerca è testare le ipotesi con un potere statistico adeguato. Condurre studi con un alto potere statistico aumenta la probabilità di documentare non solo effetti reali, ma anche effetti replicabili. Mentre l'analisi della potenza per gli effetti principali è relativamente semplice, l'analisi della potenza per le interazioni di primo ordine (cioè le interazioni a due vie, che qui chiameremo semplicemente \"interazioni\") presenta due importanti sfide.\n\nIn primo luogo, condurre un'analisi di potenza appropriata per le interazioni non è facilmente realizzabile con software come G*Power (Faul et al., 2007) o pacchetti R come `pwr` (Champely et al., 2017), perché la dimensione dell'effetto attesa di un'interazione dipende dalla sua forma (Maxwell & Delaney, 2004). In secondo luogo, ottenere un potere sufficiente per rilevare le interazioni non è un compito facile, poiché le dimensioni degli effetti delle interazioni sono spesso piccole e, di conseguenza, la dimensione del campione necessaria è spesso molto grande (Brysbaert, 2019).\n\nNelle simulazioni condotte da @sommet2023many, diversi tipi di interazioni sono stati esaminati per determinare la dimensione del campione necessaria a ottenere un potere di 0.8 con una piccola dimensione dell'effetto atteso. \n\n1. **Interazione di tipo \"reversed\" (invertita)**: Se l'interazione mostra un effetto invertito, è necessaria una dimensione campionaria di N = 784 per ottenere un potere di 0.8.\n\n2. **Interazione \"fully attenuated\" (completamente attenuata)**: Quando l'interazione è completamente attenuata, il che significa che l'effetto è notevolmente ridotto o quasi nullo in determinate condizioni, la dimensione campionaria necessaria per ottenere un potere di 0.8 sale a N = 3136.\n\n3. **Interazione \"partially attenuated\" (parzialmente attenuata)**: Per un'interazione parzialmente attenuata, dove l'effetto è ridotto solo parzialmente in alcune condizioni, è necessaria una dimensione campionaria di N = 5575 per raggiungere un potere di 0.8.\n\n[Andrew Gelman](https://statmodeling.stat.columbia.edu/2018/03/15/need-16-times-sample-size-estimate-interaction-estimate-main-effect/) ha sottolineato che per stimare un'interazione è necessaria una dimensione del campione 16 volte maggiore rispetto a quella necessaria per stimare un effetto principale. In generale, possiamo dire che questa differenza, e i risultati delle simulazioni di @sommet2023many presentati sopra, si spiegano con la natura delle interazioni: esse rappresentano effetti più sottili e complessi rispetto agli effetti principali, in quanto descrivono come l'effetto di una variabile cambia in funzione dei livelli di un'altra variabile. Questo livello aggiuntivo di complessità richiede una maggiore quantità di dati per essere rilevato e stimato con precisione.\n\nInoltre, la forma delle interazioni e il modo in cui le pendenze semplici (gli effetti principali a livelli specifici di un’altra variabile) si intersecano dipendono dalla grandezza dell'effetto di interazione rispetto alla magnitudine degli effetti principali. Questo rapporto determina se l'interazione produce:\n\n- **Un effetto attenuato**: l'effetto di una variabile è ridotto, ma non eliminato, dalla presenza di un'altra variabile.\n- **Un effetto \"knock-out\"**: l'effetto di una variabile è completamente eliminato in presenza di un'altra variabile.\n- **Un effetto \"crossover\"**: l'effetto di una variabile si inverte in presenza di un'altra variabile, mostrando un cambiamento completo nella direzione dell'effetto.\n\nCiascuno di questi scenari richiede una quantità notevole di dati per essere adeguatamente caratterizzato e distinto dagli effetti principali.\n\nIn sintesi, le interazioni richiedono un maggiore potere statistico rispetto agli effetti principali in un modello di regressione, poiché rappresentano effetti più complessi che necessitano di una maggiore quantità di dati per essere rilevati e stimati con precisione. La loro dipendenza dal contesto e la relazione con gli effetti principali rendono necessario un campione più ampio per distinguerle in modo affidabile dal rumore statistico e caratterizzarle adeguatamente.\n\n## Riflessioni Conclusive\n\nQuesto capitolo ha introdotto il concetto di interazione, che permette di considerare come l'associazione tra un predittore e un esito possa dipendere dal valore di un altro predittore. Le interazioni sono importanti per fare inferenze accurate, ma possono risultare difficili da interpretare. \n\nNel capitolo, abbiamo esaminato tre tipi di errori comuni nell'interpretazione delle interazioni, come illustrato da @spake2023understanding. Inoltre, abbiamo discusso alcune considerazioni presentate da @McElreath_rethinking, che collegano il concetto di interazione a quello di condizionamento e, di conseguenza, all'analisi causale. Infine, abbiamo esplorato le considerazioni relative alla dimensione campionaria necessaria per rilevare e misurare correttamente le interazioni.\n\n## Informazioni sull'Ambiente di Sviluppo {.unnumbered} \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.4.2 (2024-10-31)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.2\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] viridis_0.6.5     viridisLite_0.4.2 gridExtra_2.3     patchwork_1.3.0  \n#>  [5] bayesplot_1.11.1  psych_2.4.6.26    scales_1.3.0      markdown_1.13    \n#>  [9] knitr_1.49        lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    \n#> [13] dplyr_1.1.4       purrr_1.0.2       readr_2.1.5       tidyr_1.3.1      \n#> [17] tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0   rio_1.2.3        \n#> [21] here_1.0.1       \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] utf8_1.2.4        generics_0.1.3    stringi_1.8.4     lattice_0.22-6   \n#>  [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.1   \n#>  [9] grid_4.4.2        timechange_0.3.0  fastmap_1.2.0     rprojroot_2.0.4  \n#> [13] jsonlite_1.8.9    fansi_1.0.6       mnormt_2.1.1      cli_3.6.3        \n#> [17] rlang_1.1.4       munsell_0.5.1     withr_3.0.2       tools_4.4.2      \n#> [21] parallel_4.4.2    tzdb_0.4.0        colorspace_2.1-1  pacman_0.5.1     \n#> [25] vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4   htmlwidgets_1.6.4\n#> [29] pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.6      glue_1.8.0       \n#> [33] xfun_0.49         tidyselect_1.2.1  farver_2.1.2      htmltools_0.5.8.1\n#> [37] nlme_3.1-166      labeling_0.4.3    rmarkdown_2.29    compiler_4.4.2\n```\n:::\n\n\n\n\n## Bibliografia {.unnumbered}\n\n",
    "supporting": [
      "07_interactions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}